SELECT
    p.id,
    p.created_at,
    p.id_compra_cliente,
    p.cliente_id,
    p.estado_id,
    p.asignado_a_id,
    p.fecha_plazo,
    p.solicitud_cliente_texto,
    p.lista_solicitud,
		p.fecha_cierre,

    -- **Conversi√≥n con CAST para intentar que el driver de Appsmith lo reconozca**
    CAST(p.urls_solicitud_adjuntos AS json) AS urls_solicitud_adjuntos, 
    CAST(p.comentarios AS json) AS comentarios,
    CAST(p.historial_estados AS json) AS historial_estados,
    CAST(p.documentos_internos AS json) AS documentos_internos,
    
    c.nombre AS nombre_cliente,
    c.cliente_wa,
    me.estado_interno,
    me.descripcion_cliente,
    me.descripcion_interna,
    col.nombre AS nombre_asignado
FROM
    pedidos p
LEFT JOIN
    clientes c ON p.cliente_id = c.id
LEFT JOIN
    maestro_estados me ON p.estado_id = me.id
LEFT JOIN
    colaboradores col ON p.asignado_a_id = col.id
WHERE
    p.id = {{ (this.params && this.params.id) ? this.params.id : (appsmith.store.currentPedidoId || 0) }};